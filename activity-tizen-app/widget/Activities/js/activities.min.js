var active;var types={DEV:"Developer",SM:"Scrum Master"};function loadActive(){showButtonsBody(false);showMinutesBody(false);showActiveBody(false);get(active_url,setActive);}function handleActivity(a){showButtonsBody(false);showActiveBody(false);var b={type:a};if(active&&a===active.type){log("[DEBUG] Handling stoping of type :"+a);post(stop_url,b,afterStoped);}else{log("[DEBUG] Handling type change :"+a);post(start_url,b,setActive);}}function stopActivity(){showButtonsBody(false);showActiveBody(false);post(stop_url,{},afterStoped);}function afterStoped(a){showMinutes(a);setNoActivity();}function showMinutes(a){if(a.target.readyState===4&&a.target.status===200){if(a.target.responseText){log("[DEBUG] Activity stoped, showing minutes");var b=JSON.parse(a.target.responseText);var c=b.type;document.getElementById("minutes").textContent="+ "+b.minutes+"m";document.getElementById("minutes_type").textContent=types[c];showMinutesBody(true);setTimeout(function(){document.getElementById("minutes").textContent="";document.getElementById("minutes_type").textContent="";showButtonsBody(true);showMinutesBody(false);},3000);}}}function setActive(a){if(a.target.readyState===4&&a.target.status===200){log("[DEBUG] Recived data from active");if(a.target.responseText){active=JSON.parse(a.target.responseText);log("[DEBUG] Active present , setting");var c=active.type;document.getElementById("active_start").textContent=active.startTime.replace("T"," ");document.getElementById("active_time").textContent=active.minutes+"m";var b=new Date(active.startTime);document.getElementById("active_icon").src="images/"+c+".png";document.getElementById("active_text").textContent=types[c];showActiveBody(true);}else{log("[DEBUG] No active task , showing buttons, reseting active screen");showButtonsBody(true);setNoActivity();}}}function setNoActivity(){active={};document.getElementById("SM_btn").src="images/SM.png";document.getElementById("DEV_btn").src="images/DEV.png";document.getElementById("active_time").textContent="";document.getElementById("active_text").textContent="";document.getElementById("active_icon").src="";showActiveBody(false);}